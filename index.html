<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Links</title>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --bg-color: #0f0c29;
            --card-bg: rgba(255, 255, 255, 0.08);
            --text-color: #ffffff;
            --accent: #00d2ff;
        }
        body {
            font-family: 'Kanit', sans-serif;
            margin: 0;
            min-height: 100vh;
            background: linear-gradient(135deg, #1a1a2e, #16213e, #0f3460);
            color: var(--text-color);
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 40px 20px;
        }

        /* Profile Section */
        .profile-section { text-align: center; margin-bottom: 35px; animation: fadeIn 0.8s ease; }
        .profile-img {
            width: 120px; height: 120px;
            border-radius: 50%;
            border: 3px solid var(--accent);
            padding: 4px;
            object-fit: cover;
            margin-bottom: 15px;
            box-shadow: 0 0 30px rgba(0, 210, 255, 0.3);
        }
        h1 { margin: 0; font-size: 1.8rem; font-weight: 600; }
        p.bio { opacity: 0.7; margin-top: 5px; font-weight: 300; font-size: 0.95rem; max-width: 400px; line-height: 1.5; }

        /* Links Section */
        .container { width: 100%; max-width: 500px; padding-bottom: 60px; }
        
        .link-card {
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            padding: 16px 20px;
            margin-bottom: 14px;
            border-radius: 16px;
            text-decoration: none;
            color: white;
            display: flex;
            align-items: center;
            border: 1px solid rgba(255,255,255,0.1);
            transition: all 0.25s ease;
            position: relative;
            overflow: hidden;
        }

        .link-card:hover {
            transform: translateY(-3px);
            background: rgba(255, 255, 255, 0.15);
            border-color: var(--accent);
            box-shadow: 0 8px 20px rgba(0,0,0,0.2);
        }

        .link-icon { font-size: 1.5rem; margin-right: 18px; width: 30px; text-align: center; color: var(--accent); }
        .link-text { font-size: 1.05rem; font-weight: 500; }
        
        /* ‡∏™‡∏±‡∏ç‡∏•‡∏±‡∏Å‡∏©‡∏ì‡πå‡∏Å‡∏∏‡∏ç‡πÅ‡∏à‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Private Link */
        .private-badge {
            margin-left: auto;
            font-size: 0.8rem;
            color: #ffbd00;
            background: rgba(255, 189, 0, 0.15);
            padding: 4px 8px;
            border-radius: 10px;
        }

        /* Unlock Button */
        .unlock-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(5px);
            color: #aaa;
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 50%;
            width: 45px; height: 45px;
            display: flex; justify-content: center; align-items: center;
            cursor: pointer;
            transition: 0.3s;
            z-index: 100;
        }
        .unlock-btn:hover, .unlock-btn.active { color: #ffbd00; border-color: #ffbd00; background: rgba(255, 189, 0, 0.1); }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* Admin Footer Link */
        .admin-link { margin-top: auto; color: rgba(255,255,255,0.2); text-decoration: none; font-size: 0.8rem; }
        .admin-link:hover { color: var(--accent); }
    </style>
</head>
<body>

    <div class="profile-section" id="profile-section">
        <div style="padding: 20px;">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå...</div>
    </div>

    <div class="container" id="links-container">
        <div style="text-align: center; opacity: 0.5;">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏•‡∏¥‡∏á‡∏Å‡πå...</div>
    </div>

    <a href="admin.html" class="admin-link"><i class="fas fa-cog"></i> Manage</a>

    <button class="unlock-btn" id="unlockBtn" onclick="togglePrivateMode()">
        <i class="fas fa-lock"></i>
    </button>

    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>

    <script>
        // --- ‚ö†Ô∏è ‡πÉ‡∏™‡πà Config ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà ---
        const firebaseConfig = {
            apiKey: "AIzaSyB-Brx6cQ7dFhQqbEhDG4xIT4jcVG1yogs",
            authDomain: "mylinks-web.firebaseapp.com",
            projectId: "mylinks-web",
            storageBucket: "mylinks-web.firebasestorage.app",
            messagingSenderId: "702413304222",
            appId: "1:702413304222:web:d255e6c2f428bb1e1d668f"
        };

        if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        let isPrivateUnlocked = false; // ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Ñ
        let secretCode = "1234"; // ‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô (‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏ó‡∏±‡∏ö‡∏î‡πâ‡∏ß‡∏¢‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å DB)

        // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Profile
        function loadProfile() {
            db.doc("settings/profile").get().then((doc) => {
                if (doc.exists) {
                    const data = doc.data();
                    // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏£‡∏´‡∏±‡∏™‡∏•‡∏±‡∏ö ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏ï‡∏±‡πâ‡∏á‡πÑ‡∏ß‡πâ
                    if(data.secretCode) secretCode = data.secretCode;
                    
                    document.getElementById('profile-section').innerHTML = `
                        <img src="${data.imageUrl || 'https://ui-avatars.com/api/?name=User'}" class="profile-img">
                        <h1>${data.name || 'My Links'}</h1>
                        <p class="bio">${data.bio || ''}</p>
                    `;
                } else {
                    // ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡πà‡∏≤ Default
                    document.getElementById('profile-section').innerHTML = `
                        <img src="https://ui-avatars.com/api/?name=User" class="profile-img">
                        <h1>‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö</h1>
                        <p class="bio">‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤ Admin ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå</p>
                    `;
                }
            });
        }

        // ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏•‡∏¥‡∏á‡∏Å‡πå
        function loadLinks() {
            const container = document.getElementById('links-container');
            
            db.collection("links").orderBy("createdAt", "desc").get().then((querySnapshot) => {
                container.innerHTML = ''; 
                
                if(querySnapshot.empty) {
                    container.innerHTML = '<p style="text-align:center; opacity:0.5;">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏•‡∏¥‡∏á‡∏Å‡πå</p>';
                    return;
                }

                querySnapshot.forEach((doc) => {
                    const link = doc.data();
                    const iconClass = link.icon || 'fas fa-link';
                    
                    // ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô Private Link ‡πÅ‡∏•‡∏∞‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Ñ -> ‡∏Ç‡πâ‡∏≤‡∏° ‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á
                    if (link.isPrivate && !isPrivateUnlocked) return;

                    // ‡∏ñ‡πâ‡∏≤‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Ñ‡πÅ‡∏•‡πâ‡∏ß ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà Private -> ‡πÅ‡∏™‡∏î‡∏á
                    let badge = '';
                    if (link.isPrivate) {
                        badge = '<span class="private-badge"><i class="fas fa-lock"></i> ‡∏•‡∏±‡∏ö</span>';
                    }

                    const html = `
                        <a href="${link.url}" target="_blank" class="link-card">
                            <div class="link-icon"><i class="${iconClass}"></i></div>
                            <div class="link-text">${link.title}</div>
                            ${badge}
                        </a>
                    `;
                    container.innerHTML += html;
                });
            });
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Ñ‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏•‡∏±‡∏ö
        function togglePrivateMode() {
            if (isPrivateUnlocked) {
                // ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡∏¥‡∏î‡∏≠‡∏¢‡∏π‡πà ‡πÉ‡∏´‡πâ‡∏õ‡∏¥‡∏î (Lock)
                isPrivateUnlocked = false;
                document.getElementById('unlockBtn').classList.remove('active');
                document.getElementById('unlockBtn').innerHTML = '<i class="fas fa-lock"></i>';
                loadLinks(); // ‡πÇ‡∏´‡∏•‡∏î‡πÉ‡∏´‡∏°‡πà (‡∏ã‡πà‡∏≠‡∏ô‡∏ï‡∏±‡∏ß‡∏•‡∏±‡∏ö)
            } else {
                // ‡∏ñ‡πâ‡∏≤‡∏õ‡∏¥‡∏î‡∏≠‡∏¢‡∏π‡πà ‡πÉ‡∏´‡πâ‡∏ñ‡∏≤‡∏°‡∏£‡∏´‡∏±‡∏™
                const input = prompt("üîí ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏•‡∏±‡∏ö:");
                if (input === secretCode) {
                    alert("üîì ‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Ñ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢!");
                    isPrivateUnlocked = true;
                    document.getElementById('unlockBtn').classList.add('active');
                    document.getElementById('unlockBtn').innerHTML = '<i class="fas fa-lock-open"></i>';
                    loadLinks(); // ‡πÇ‡∏´‡∏•‡∏î‡πÉ‡∏´‡∏°‡πà (‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏±‡∏ß‡∏•‡∏±‡∏ö)
                } else if (input !== null) {
                    alert("‚ùå ‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á");
                }
            }
        }

        // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô
        loadProfile();
        loadLinks();

    </script>
</body>
</html>
